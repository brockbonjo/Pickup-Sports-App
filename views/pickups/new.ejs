<%- include('../partials/header') %>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJPsnFimaA4YhK6htIku8Cz0gM10FtA1I&callback=initMap"> </script>

<main class="new">

<form class="" action="/soccer" method="POST">
  <div class="newDetails">
    <div class="leftNew">
      <div class="sport">
        <label for="">Choose your Sport:</label>
        <select class="" name="sport">
          <option value="soccer">Soccer</option>
          <option value="football">Football</option>
          <option value="frisbee">Ultimate Frisbee</option>
        </select>
      </div>
        <div class="locations">
        <label for="">Select a location</label> <br>
        <input type="number" name="lat" id="lat" readonly>
        <input type="number" name="lon" id="lon" readonly>
      </div>
      <div class="newComments">
        <label for="">Comments on the location</label>
        <input type="text" name="hostComments" value="">
      </div>
      <div class="numPlayersNew">
        <label for="">How many players are starting with you?</label>
        <input type="text" name="numOriginalPlayers" value="">
      </div>
    </div>
    <div class="rightNew">
      <div class="map">
        <div id="map"></div>
        <script id="map" type="text/javascript">
<<<<<<< HEAD

          var map, marker;

          function initMap() {
            var options = {
              zoom: 12,
              center:  {lat: 30.2672, lng:-97.7431},
              zoomControl: false,
              streetViewControl: false,
              mapTypeControl: false,

            }

            map = new google.maps.Map(document.getElementById('map'), options);
            marker = new google.maps.Marker;

            //centers map on user location
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(function(position) {
                var pos = {
                  lat: position.coords.latitude,
                  lng: position.coords.longitude
                };
                map.setCenter(pos);})
              } else {
                // Browser doesn't support Geolocation, sets location to Austin
                map.setCenter({lat: 30.2672, lng:-97.7431});
            }

            var markers = [
            /*{
              coords: {lat: 30.267490630430462, lng: -97.76876091957092 },
              map: map,
            },*/
            ];


            function setMapOnAll(map) {
              for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
              }
            }
            function clearMarkers() {
              setMapOnAll(null);
            }
            function pleaseWork(props) {
              var marker = new google.maps.Marker({
                position: props.coords,
                map: map,
              });
            }
            //adds event listener for marker, lat/lon to form
            google.maps.event.addListener(map, 'click', function(event){
              clearMarkers();
              var lat = event.latLng.lat()
              var lng = event.latLng.lng()
              document.getElementById('lat').value = lat;
              document.getElementById('lon').value = lng;
              var marker = new google.maps.Marker({
                position: {lat: lat, lng: lng},
                map: map,
              });
              console.log(marker);
              markers.push(marker);
              /*for(var i = 0; i < markers.length; i++) {
                if (markers[i]) {
                  pleaseWork(markers[i]);
                }
              }*/
              // addMarker({coords:event.latLng});
            });

            //TO DELETE. RUNS ON LOAD Only runs for what is in the above markers array
            /*for(var i = 0; i < markers.length; i++) {
              console.log(markers[i]);
              addMarker(markers[i]);
            }*/
=======
          function initMap() {
            var options = {
              zoom: 10,
              center: {lat: 30.2672, lng:-97.7431}
            }

            var map = new google.maps.Map(document.getElementById('map'), options);

            google.maps.event.addListener(map, 'click', function(event){
              document.getElementById('lat').value = event.latLng.lat();
              document.getElementById('lon').value = event.latLng.lng();
              addMarker({coords:event.latLng});
              // return (event.latLng.lat(), event.latLng.lng());
            });
            // console.log(event.latLng.lat() + ', ' + event.latLng.lng());
            var markers = [
              /*{
                coords: {lat: 30.267490630430462, lng: -97.76876091957092 },
                content: '<h2> Zilker Park Great Field</h2>'
              },
              {
                coords: {lat: 30.17627525018336, lng: -97.74337626739577 },
                content: '<h2>Onion Creek Soccer Complex</h2>'
              },
              {
                coords: {lat: 30.28123286605467, lng: -97.73457361095086 },
                content: '<h2>UT Campbell Fields</h2>'
              }*/
            ];

            for(var i = 0; i < markers.length; i++) {
              addMarker(markers[i]);
            }
>>>>>>> a6b456bb5c11ff669b3018ea2b81693e71e96eb6

            function addMarker(props) {
              var marker = new google.maps.Marker({
                position: props.coords,
                map: map,
              });
<<<<<<< HEAD
            }
          }
=======
              if(props.content){
                var infoWindow = new google.maps.InfoWindow({
                 content: props.content
               });

               marker.addListener('click', function() {
                 infoWindow.open(map, marker);
               });
              }
            }
          }

        // addMarker({coords: {lat: 30.2672, lng:-97.7431},
        //   content: '<h1>Austin, TX</h1>'
        // }
>>>>>>> a6b456bb5c11ff669b3018ea2b81693e71e96eb6
        </script>


      </div>
    </div>

  </div>
  <input type="submit" value="Add Game">
</form>

</main>


<%- include('../partials/footer') %>
